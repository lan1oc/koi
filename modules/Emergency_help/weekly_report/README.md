# å‘¨æŠ¥ç”Ÿæˆæ¨¡å—

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„å·¥ä½œå‘¨æŠ¥è‡ªåŠ¨ç”Ÿæˆæ¨¡å—ï¼Œé€šè¿‡åˆ†æç³»ç»Ÿæ–‡ä»¶æ´»åŠ¨è®°å½•ï¼Œè‡ªåŠ¨ç”Ÿæˆå·¥ä½œå‘¨æŠ¥ã€‚

## ğŸ“ æ¨¡å—ç»“æ„

```
weekly_report/
â”œâ”€â”€ __init__.py                    # æ¨¡å—åˆå§‹åŒ–æ–‡ä»¶
â”œâ”€â”€ weekly_report_generator.py     # å‘¨æŠ¥ç”Ÿæˆå™¨æ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ weekly_report_ui.py           # å‘¨æŠ¥ç”ŸæˆUIç»„ä»¶
â”œâ”€â”€ integration_helper.py         # é›†æˆåŠ©æ‰‹
â””â”€â”€ README.md                     # æœ¬æ–‡ä»¶
```

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### ğŸ“Š æ™ºèƒ½æ–‡ä»¶åˆ†æ (WeeklyReportGenerator)
- âœ… ä»Windowsæ³¨å†Œè¡¨è·å–æœ€è¿‘æ–‡ä»¶è®°å½•
- âœ… ä»æœ€è¿‘æ–‡ä»¶å¤¹è·å–æ–‡ä»¶æ´»åŠ¨
- âœ… æ™ºèƒ½è¯†åˆ«å·¥ä½œç›¸å…³æ–‡ä»¶
- âœ… è‡ªåŠ¨æå–ä¼ä¸šåç§°
- âœ… å·¥ä½œç±»å‹åˆ†ç±»ç»Ÿè®¡
- âœ… æ”¯æŒå¤šç§æ—¶é—´èŒƒå›´ç»Ÿè®¡
- âœ… ç”Ÿæˆè¯¦ç»†æˆ–ç®€è¦æŠ¥å‘Š

### ğŸ¨ ç°ä»£åŒ–ç•Œé¢ (WeeklyReportUI)
- âœ… ç›´è§‚çš„é…ç½®é¢æ¿
- âœ… å®æ—¶çŠ¶æ€æ˜¾ç¤º
- âœ… ç¾è§‚çš„ç»“æœå±•ç¤º
- âœ… å“åº”å¼å¸ƒå±€è®¾è®¡
- âœ… å¤šçº¿ç¨‹å¤„ç†ï¼Œç•Œé¢ä¸å¡é¡¿

### ğŸ”§ é›†æˆæ”¯æŒ (IntegrationHelper)
- âœ… ç®€å•çš„é›†æˆæ¥å£
- âœ… å®Œå…¨æ¨¡å—åŒ–è®¾è®¡
- âœ… ä¸ä¸»ç¨‹åºæ— ç¼é›†æˆ

## ğŸ“¦ ä¾èµ–è¦æ±‚

```bash
PySide6>=6.0.0
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. åŸºç¡€ä½¿ç”¨

```python
from modules.Emergency_help.weekly_report import WeeklyReportGenerator

# åˆ›å»ºå‘¨æŠ¥ç”Ÿæˆå™¨
generator = WeeklyReportGenerator()

# ç”Ÿæˆæœ¬å‘¨å·¥ä½œæ—¥æŠ¥å‘Š
report = generator.generate_report()
print(report)

# ç”Ÿæˆæœ€è¿‘7å¤©çš„è¯¦ç»†æŠ¥å‘Š
detailed_report = generator.generate_report(days=7, detailed=True)
print(detailed_report)
```

### 2. UIç•Œé¢ä½¿ç”¨

```python
from modules.Emergency_help.weekly_report import WeeklyReportUI
from PySide6.QtWidgets import QApplication
import sys

# åˆ›å»ºåº”ç”¨ç¨‹åº
app = QApplication(sys.argv)

# åˆ›å»ºå‘¨æŠ¥UI
weekly_ui = WeeklyReportUI()
weekly_ui.setWindowTitle("å‘¨æŠ¥ç”Ÿæˆå™¨")
weekly_ui.resize(1000, 700)
weekly_ui.show()

# è¿è¡Œåº”ç”¨ç¨‹åº
sys.exit(app.exec())
```

### 3. é›†æˆåˆ°ä¸»ç¨‹åº

```python
from modules.Emergency_help.weekly_report.integration_helper import integrate_weekly_report_to_emergency_help

# åœ¨åˆ›å»ºæ±Ÿæ¹–æ•‘æ€¥æ ‡ç­¾é¡µæ—¶é›†æˆ
class MainWindow(QMainWindow):
    def create_emergency_tools_tab(self):
        # åˆ›å»ºæ±Ÿæ¹–æ•‘æ€¥ä¸»æ ‡ç­¾é¡µ
        emergency_widget = QWidget()
        emergency_layout = QVBoxLayout(emergency_widget)
        
        # åˆ›å»ºå­æ ‡ç­¾é¡µ
        emergency_tabs = QTabWidget()
        
        # é›†æˆå‘¨æŠ¥ç”ŸæˆåŠŸèƒ½
        self.weekly_report_ui = integrate_weekly_report_to_emergency_help(emergency_tabs)
        
        # æ·»åŠ å…¶ä»–åŠŸèƒ½æ ‡ç­¾é¡µ...
        
        emergency_layout.addWidget(emergency_tabs)
        self.tab_widget.addTab(emergency_widget, "ğŸ†˜ æ±Ÿæ¹–æ•‘æ€¥")
```

## ğŸ“‹ APIæ–‡æ¡£

### WeeklyReportGenerator

#### ä¸»è¦æ–¹æ³•
- `generate_report(days=None, detailed=False)` - ç”Ÿæˆå·¥ä½œå‘¨æŠ¥
  - `days`: ç»Ÿè®¡å¤©æ•°ï¼ŒNoneè¡¨ç¤ºæœ¬å‘¨å·¥ä½œæ—¥
  - `detailed`: æ˜¯å¦ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
  - è¿”å›: ç”Ÿæˆçš„å‘¨æŠ¥å†…å®¹å­—ç¬¦ä¸²

#### ç§æœ‰æ–¹æ³•
- `_collect_file_activities(start_date, end_date)` - æ”¶é›†æ–‡ä»¶æ´»åŠ¨è®°å½•
- `_get_recent_files_from_registry()` - ä»æ³¨å†Œè¡¨è·å–æœ€è¿‘æ–‡ä»¶
- `_get_recent_files_from_folder()` - ä»æœ€è¿‘æ–‡ä»¶å¤¹è·å–æ–‡ä»¶
- `_analyze_work_content(file_records)` - åˆ†æå·¥ä½œå†…å®¹
- `_generate_report_content(date_range, analysis, detailed, file_records)` - ç”ŸæˆæŠ¥å‘Šå†…å®¹

### WeeklyReportUI

#### ä¸»è¦æ–¹æ³•
- `generate_weekly_report()` - ç”Ÿæˆå·¥ä½œå‘¨æŠ¥
- `clear_weekly_report()` - æ¸…ç©ºå‘¨æŠ¥ç»“æœ
- `update_report_progress(message)` - æ›´æ–°ç”Ÿæˆè¿›åº¦
- `on_report_completed(report)` - æŠ¥å‘Šç”Ÿæˆå®Œæˆå›è°ƒ

#### UIç»„ä»¶
- `report_range_combo` - æ—¶é—´èŒƒå›´é€‰æ‹©ä¸‹æ‹‰æ¡†
- `report_type_combo` - æŠ¥å‘Šç±»å‹é€‰æ‹©ä¸‹æ‹‰æ¡†
- `weekly_report_result` - ç»“æœæ˜¾ç¤ºæ–‡æœ¬æ¡†
- `report_status_label` - çŠ¶æ€æ˜¾ç¤ºæ ‡ç­¾

### IntegrationHelper

#### é›†æˆå‡½æ•°
- `create_weekly_report_tab(parent_tab_widget)` - åˆ›å»ºå‘¨æŠ¥ç”Ÿæˆé€‰é¡¹å¡
- `integrate_weekly_report_to_emergency_help(emergency_help_tabs)` - é›†æˆåˆ°æ±Ÿæ¹–æ•‘æ€¥
- `add_weekly_report_methods_to_main_window(main_window)` - æ·»åŠ æ–¹æ³•åˆ°ä¸»çª—å£

## ğŸ¯ å·¥ä½œåŸç†

### æ–‡ä»¶æ”¶é›†æœºåˆ¶
1. **æ³¨å†Œè¡¨æ‰«æ**: ä»Officeåº”ç”¨ç¨‹åºçš„MRUï¼ˆMost Recently Usedï¼‰è®°å½•ä¸­è·å–æœ€è¿‘æ–‡ä»¶
2. **ç³»ç»Ÿæ–‡ä»¶å¤¹**: æ‰«æWindowsæœ€è¿‘æ–‡ä»¶å¤¹ä¸­çš„å¿«æ·æ–¹å¼
3. **æ—¶é—´è¿‡æ»¤**: æ ¹æ®æŒ‡å®šæ—¶é—´èŒƒå›´è¿‡æ»¤æ–‡ä»¶è®°å½•
4. **å»é‡å¤„ç†**: åˆå¹¶é‡å¤çš„æ–‡ä»¶è®°å½•

### æ™ºèƒ½åˆ†æç®—æ³•
1. **å…³é”®è¯åŒ¹é…**: ä½¿ç”¨é¢„å®šä¹‰çš„å·¥ä½œå…³é”®è¯è¯†åˆ«å·¥ä½œç›¸å…³æ–‡ä»¶
2. **ä¼ä¸šåç§°æå–**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æå–æ–‡ä»¶åä¸­çš„ä¼ä¸šä¿¡æ¯
3. **å·¥ä½œç±»å‹åˆ†ç±»**: æ ¹æ®æ–‡ä»¶åç‰¹å¾è‡ªåŠ¨åˆ†ç±»å·¥ä½œç±»å‹
4. **ç»Ÿè®¡åˆ†æ**: ç”Ÿæˆå„ç§ç»´åº¦çš„ç»Ÿè®¡ä¿¡æ¯

### æŠ¥å‘Šç”Ÿæˆæµç¨‹
1. **æ•°æ®æ”¶é›†**: æ”¶é›†æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„æ–‡ä»¶æ´»åŠ¨
2. **å†…å®¹åˆ†æ**: åˆ†ææ–‡ä»¶å†…å®¹ï¼Œæå–å·¥ä½œä¿¡æ¯
3. **æŠ¥å‘Šç»„è£…**: æŒ‰ç…§æ¨¡æ¿æ ¼å¼ç»„è£…æœ€ç»ˆæŠ¥å‘Š
4. **æ ¼å¼åŒ–è¾“å‡º**: ç”ŸæˆMarkdownæ ¼å¼çš„å‘¨æŠ¥å†…å®¹

## ğŸ” é…ç½®é€‰é¡¹

### æ—¶é—´èŒƒå›´é€‰é¡¹
- **æœ¬å‘¨å·¥ä½œæ—¥**: ä»æœ¬å‘¨ä¸€åˆ°ä»Šå¤©
- **æœ€è¿‘3å¤©**: æœ€è¿‘3å¤©çš„æ–‡ä»¶æ´»åŠ¨
- **æœ€è¿‘7å¤©**: æœ€è¿‘ä¸€å‘¨çš„æ–‡ä»¶æ´»åŠ¨
- **æœ€è¿‘14å¤©**: æœ€è¿‘ä¸¤å‘¨çš„æ–‡ä»¶æ´»åŠ¨
- **æœ€è¿‘30å¤©**: æœ€è¿‘ä¸€ä¸ªæœˆçš„æ–‡ä»¶æ´»åŠ¨

### æŠ¥å‘Šç±»å‹
- **ç®€è¦æŠ¥å‘Š**: åŒ…å«åŸºæœ¬ç»Ÿè®¡å’Œä¸»è¦å·¥ä½œå†…å®¹
- **è¯¦ç»†æŠ¥å‘Š**: åŒ…å«å®Œæ•´çš„æ–‡ä»¶åˆ—è¡¨å’Œè¯¦ç»†åˆ†æ

## ğŸ› ï¸ è‡ªå®šä¹‰æ‰©å±•

### æ·»åŠ æ–°çš„å·¥ä½œå…³é”®è¯

```python
# åœ¨WeeklyReportGenerator.__init__ä¸­ä¿®æ”¹
self.work_keywords = [
    'æ¼æ´', 'æ‰«æ', 'æ¸—é€', 'æµ‹è¯•', 'å®‰å…¨', 'è¯„ä¼°', 'æŠ¥å‘Š', 'æ£€æµ‹',
    'ä¿®å¤', 'åŠ å›º', 'é˜²æŠ¤', 'ç›‘æ§', 'å®¡è®¡', 'åˆè§„', 'é£é™©',
    'vulnerability', 'scan', 'penetration', 'test', 'security',
    'assessment', 'report', 'detection', 'fix', 'hardening',
    # æ·»åŠ æ–°çš„å…³é”®è¯
    'æ–°å…³é”®è¯1', 'æ–°å…³é”®è¯2'
]
```

### è‡ªå®šä¹‰ä¼ä¸šåç§°åŒ¹é…è§„åˆ™

```python
# åœ¨WeeklyReportGenerator.__init__ä¸­ä¿®æ”¹
self.company_patterns = [
    r'([\u4e00-\u9fa5]+(?:å…¬å¸|é›†å›¢|ä¼ä¸š|ç§‘æŠ€|ç½‘ç»œ|ä¿¡æ¯|ç³»ç»Ÿ|è½¯ä»¶|æŠ€æœ¯))',
    r'([A-Za-z]+(?:\s+(?:Inc|Corp|Ltd|Co|Company|Group|Tech|Technology)))',
    # æ·»åŠ æ–°çš„åŒ¹é…è§„åˆ™
    r'æ–°çš„æ­£åˆ™è¡¨è¾¾å¼è§„åˆ™'
]
```

### è‡ªå®šä¹‰å·¥ä½œç±»å‹åˆ†ç±»

```python
# åœ¨_analyze_work_contentæ–¹æ³•ä¸­ä¿®æ”¹work_typeså­—å…¸
analysis['work_types'] = {
    'æ¼æ´æ‰«æ': 0,
    'æ¸—é€æµ‹è¯•': 0,
    'å®‰å…¨è¯„ä¼°': 0,
    'æŠ¥å‘Šç¼–å†™': 0,
    'æ–°å·¥ä½œç±»å‹': 0,  # æ·»åŠ æ–°çš„å·¥ä½œç±»å‹
    'å…¶ä»–': 0
}
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æ–‡ä»¶æ‰«æä¼˜åŒ–
- ä½¿ç”¨å¤šçº¿ç¨‹å¤„ç†ï¼Œé¿å…ç•Œé¢å¡é¡¿
- æ™ºèƒ½ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘é‡å¤æ‰«æ
- å¼‚å¸¸å¤„ç†ï¼Œç¡®ä¿ç¨‹åºç¨³å®šæ€§

### å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- æµå¼å¤„ç†å¤§é‡æ–‡ä»¶è®°å½•
- åŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„æ•°æ®
- ä¼˜åŒ–æ•°æ®ç»“æ„ï¼Œå‡å°‘å†…å­˜å ç”¨

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ— æ³•è·å–æ–‡ä»¶è®°å½•**
   - æ£€æŸ¥Windowsç”¨æˆ·æƒé™
   - ç¡®è®¤Officeåº”ç”¨ç¨‹åºå·²å®‰è£…
   - æ£€æŸ¥æ³¨å†Œè¡¨è®¿é—®æƒé™

2. **ç”Ÿæˆçš„æŠ¥å‘Šä¸ºç©º**
   - æ£€æŸ¥æ—¶é—´èŒƒå›´è®¾ç½®
   - ç¡®è®¤å·¥ä½œå…³é”®è¯é…ç½®
   - æ£€æŸ¥æ–‡ä»¶æ´»åŠ¨æ˜¯å¦åœ¨æŒ‡å®šæ—¶é—´å†…

3. **ç•Œé¢å¡é¡¿**
   - ç¡®è®¤ä½¿ç”¨äº†å¤šçº¿ç¨‹å¤„ç†
   - æ£€æŸ¥æ–‡ä»¶æ•°é‡æ˜¯å¦è¿‡å¤š
   - ä¼˜åŒ–æ‰«æèŒƒå›´

### è°ƒè¯•æ¨¡å¼

```python
import logging

# å¯ç”¨è°ƒè¯•æ—¥å¿—
logging.basicConfig(level=logging.DEBUG)

# åˆ›å»ºç”Ÿæˆå™¨
generator = WeeklyReportGenerator()
report = generator.generate_report()
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-01-22)
- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… å®Œæ•´çš„å‘¨æŠ¥ç”ŸæˆåŠŸèƒ½
- âœ… ç°ä»£åŒ–UIç•Œé¢
- âœ… æ¨¡å—åŒ–æ¶æ„è®¾è®¡
- âœ… é›†æˆåŠ©æ‰‹æ”¯æŒ

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªæ¨¡å—ï¼

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å®‰è£…ä¾èµ–
pip install PySide6

# è¿è¡Œæµ‹è¯•
python weekly_report_ui.py
```

### ä»£ç è§„èŒƒ
- éµå¾ªPEP 8ä»£ç é£æ ¼
- æ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£å­—ç¬¦ä¸²
- ç¼–å†™å•å…ƒæµ‹è¯•

---

*å‘¨æŠ¥ç”Ÿæˆæ¨¡å— v1.0.0 - è®©å·¥ä½œæ±‡æŠ¥æ›´ç®€å•ï¼*