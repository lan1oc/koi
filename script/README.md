# 企业查询独立脚本

本文件夹包含两个独立的企业信息查询脚本，可以脱离主程序单独运行。

## 📁 文件说明

### 1. aiqicha_standalone.py - 爱企查查询脚本
- **功能**：查询企业基本信息、行业分类、ICP备案、员工联系方式等
- **数据源**：爱企查 + 寻客宝
- **特色**：可获取员工手机号码（需寻客宝Cookie）

### 2. tianyancha_standalone.py - 天眼查查询脚本
- **功能**：查询企业基本信息、ICP备案等
- **数据源**：天眼查
- **特色**：数据权威，反爬较严格

## 🚀 使用方法

### 环境要求
```bash
pip install requests fake-useragent
```

### 运行脚本
```bash
# 爱企查查询
python aiqicha_standalone.py

# 天眼查查询
python tianyancha_standalone.py
```

## 🍪 Cookie获取方法

### 爱企查Cookie获取
1. 打开浏览器，访问 https://aiqicha.baidu.com
2. 登录你的百度账号
3. 按F12打开开发者工具
4. 切换到Network标签
5. 刷新页面
6. 找到任意请求，复制Cookie值

### 寻客宝Cookie获取（可选，用于获取联系方式）
1. 打开浏览器，访问 https://xunkebao.baidu.com
2. 登录你的百度账号
3. 按F12打开开发者工具
4. 切换到Network标签
5. 刷新页面
6. 找到任意请求，复制Cookie值

### 天眼查Cookie获取
1. 打开浏览器，访问 https://www.tianyancha.com
2. 登录你的天眼查账号
3. 按F12打开开发者工具
4. 切换到Network标签
5. 刷新页面
6. 找到任意请求，复制Cookie值

## 📤 批量查询结果导出

### 导出格式

#### 1. CSV格式
- **文件名**: `aiqicha_batch_results_YYYYMMDD_HHMMSS.csv` 或 `tianyancha_batch_results_YYYYMMDD_HHMMSS.csv`
- **编码**: UTF-8 with BOM（支持Excel直接打开中文）
- **内容**: 表格形式，包含所有企业信息字段
- **适用**: Excel、WPS、数据分析工具

#### 2. TXT格式
- **文件名**: `aiqicha_batch_results_YYYYMMDD_HHMMSS.txt` 或 `tianyancha_batch_results_YYYYMMDD_HHMMSS.txt`
- **编码**: UTF-8
- **内容**: 格式化文本，包含汇总表格和详细信息
- **适用**: 文本编辑器、报告查看

### 导出内容

#### 爱企查导出字段
- 企业名称、法人代表、注册资本、统一社会信用代码
- 企业地址、企业邮箱、企业网站、企业电话
- 行业分类（大类、中类、小类、具体分类）
- 员工企业邮箱、ICP备案信息、员工手机号码
- 查询状态（成功/失败及错误信息）

#### 天眼查导出字段
- 企业名称、法定代表人、注册资本、统一社会信用代码
- 注册地址、联系电话、邮箱、网站
- 行业分类（4级分类）、ICP备案信息
- 查询状态（成功/失败及错误信息）

### 使用方法
1. 选择批量查询模式
2. 输入企业名称列表
3. 等待查询完成
4. 选择导出格式：
   - 输入 `1`：仅导出CSV
   - 输入 `2`：仅导出TXT
   - 输入 `3`：同时导出CSV和TXT
   - 输入 `4`：不导出

### 文件示例

#### CSV文件示例
```csv
企业名称,法人代表,注册资本,统一社会信用代码,查询状态
杭州安恒信息技术股份有限公司,范渊,12000万人民币,91330000MA27XK4A9B,成功
阿里巴巴集团控股有限公司,张勇,1000万美元,91330000MA27XK4A9C,成功
```

#### TXT文件示例
```
爱企查批量查询结果报告
================================================================================
查询时间: 2024-01-15 14:30:25
查询总数: 2
成功数量: 2
失败数量: 0
================================================================================

序号 企业名称                           法人代表        注册资本        统一社会信用代码         查询状态
----------------------------------------------------------------------------------------------------
1    杭州安恒信息技术股份有限公司         范渊            12000万人民币   91330000MA27XK4A9B       成功
2    阿里巴巴集团控股有限公司             张勇            1000万美元      91330000MA27XK4A9C       成功
```

## 📋 功能对比

| 功能 | 爱企查脚本 | 天眼查脚本 |
|------|------------|------------|
| 企业基本信息 | ✅ | ✅ |
| 法人代表 | ✅ | ✅ |
| 注册资本 | ✅ | ✅ |
| 统一社会信用代码 | ✅ | ✅ |
| 注册地址 | ✅ | ✅ |
| 行业分类 | ✅ | ✅ |
| ICP备案信息 | ✅ | ✅ |
| 员工邮箱 | ✅ | ✅ |
| 员工手机号 | ✅ | ❌ |
| 企业电话 | ✅ | ✅ |
| 企业网站 | ✅ | ✅ |
| 批量查询 | ✅ | ✅ |
| 结果导出(CSV) | ✅ | ✅ |
| 结果导出(TXT) | ✅ | ✅ |

## ⚠️ 注意事项

### 1. Cookie安全
- Cookie包含敏感的登录信息，请勿泄露给他人
- 定期更新Cookie，避免过期
- 不要在公共场所输入Cookie

### 2. 反爬限制
- 两个平台都有反爬机制，请合理控制查询频率
- 天眼查反爬较严格，建议使用付费账号
- 如遇到验证码或IP封禁，请稍后重试

### 3. 数据准确性
- 查询结果仅供参考，请以官方数据为准
- 不同平台的数据可能存在差异
- 建议交叉验证重要信息

### 4. 法律合规
- 请遵守相关法律法规
- 仅用于合法的商业调研目的
- 不得用于非法用途

## 🔧 故障排除

### 常见问题

**Q: 提示Cookie无效怎么办？**
A: 重新登录网站获取最新的Cookie

**Q: 查询失败怎么办？**
A: 检查网络连接，确认Cookie是否有效，稍后重试

**Q: 获取不到员工联系方式？**
A: 确保已设置寻客宝Cookie，且账号有相应权限

**Q: 批量查询中断怎么办？**
A: 脚本会自动重试，如果仍然失败，请检查网络和Cookie

### 错误代码说明
- `请求超时`: 网络连接问题，稍后重试
- `JSON解析错误`: 返回数据格式异常，可能遇到反爬
- `未找到企业信息`: 企业名称不存在或搜索结果为空
- `Cookie无效`: 需要重新获取Cookie

## 📞 技术支持

如果遇到问题，请检查：
1. Python环境是否正确安装
2. 依赖包是否已安装
3. Cookie是否有效
4. 网络连接是否正常

---

**免责声明**: 本脚本仅供学习和合法商业用途，使用者需自行承担使用风险，遵守相关法律法规。